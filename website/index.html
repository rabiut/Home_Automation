<!DOCTYPE html>
<html>
<head>
    <meta charset ="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel ="stylesheet" href="style.css">
    <!-- <script defer src="main.js"></script> -->
    <script src="https://kit.fontawesome.com/00901c2e53.js" crossorigin="anonymous"></script>
    <link href="https://unpkg.com/video.js/dist/video-js.min.css" rel="stylesheet">
    <script src="https://unpkg.com/video.js/dist/video.min.js"></script>
    <!-- <script src="https://unpkg.com/videojs-contrib-hls/dist/videojs-contrib-hls.min.js"></script> -->
</head>
<body>
    <h1>Live Stream from ESP32-CAM</h1>
    <div class="livestream">
        <!-- Replace the img tag with a video tag -->
        <video id="my_video" class="video-js vjs-default-skin" controls preload="auto" width="640" height="480" muted autoplay data-setup='{}'>
            <source src="http://192.168.2.43:8080/hls/stream.m3u8" type="application/x-mpegURL">
        </video>
    </div>
    <!-- Added a new paragraph to display status -->
    <p id="status">No person detected</p>

    <!-- Added Socket.IO client-side script -->
    <script src="http://localhost:3000/socket.io/socket.io.js"></script>
    <script>
        const socket = io('http://localhost:3000');

        socket.on('person_detected', (data) => {
        // Update the status when a person is detected
        document.getElementById('status').textContent = `Person detected last at ${data.time}!`;
        });
    </script>
    <script>
        var player = videojs('my_video');
        document.addEventListener('click', function(){
            player.muted(false);
        });
    </script>
</body>
</html>
